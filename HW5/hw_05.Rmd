---
title: "Fifth Week: Bootstrap and Resampling Methods"
subtitle: "Nonparametric Hypothesis tests"
author: "Kimia Hamidieh (95109434)"
date: "`r Sys.time()`"
output:
  prettydoc::html_pretty:
    theme: cayman
    highlight: github
---

<div align="center">
<img  src="images/NonparametricStatistics_iStock.jpg"  align = 'center'>
</div>

> <p dir="RTL"> 
لطفا با سوالات زیر پاسخ دهید.
در همه سوالات سطح دقت را ۹۵ درصد در نظر بگیرید.
</p>

***

<p dir="RTL">
۱. شرکتی میخواهد تحقیق کند آیا درآمد نمایندگی های آن یکسان است. برای بررسی این موضوع هشت نمایندگی
به طور تصادفی انتخاب شده اند که به ترتیب میزان فروش آنها عبارت است از 
102, 300, 102, 100, 205, 105, 71 , 92.
با توجه به داده آیا عملکرد نمایندگی ها یکسان است؟
</p>


```{r}
stores = c(102, 300, 102, 100, 205, 105, 71, 92)
chisq.test(stores)
```

<p dir="RTL">
برای بررسی یکسان بودن عملکرد نمایندگیها (چند نمونه از یک متغیر categorical)، و اینکه آیا از یک توزیع خاص آمدهاند یا نه از Chi-Square Goodness of Fit Test استفاده میکنیم. با توجه به اینکه p-value به دست آمده از ۰.۰۵ کمتر است، بنابراین فرض صفر که یکسان بودن عملکرد نمایندگیهاست رد میشود و عملکرد آنها متفاوت خواهد بود.
</p>


***

<p dir="RTL">
۲. آمار فروش شرکتی در دو نوع شعبه سنتی و مدرن در زیر آمده است:
</p>

Classical stores: 50, 50, 60, 70, 75, 80, 90, 85

Modern stores: 55, 75, 80, 90, 105, 65

<p dir="RTL">
آیا تفاوتی در عملکرد دو نوع شعبه وجود دارد؟
</p>

```{r warning=FALSE}
classical_stores = c(50, 50, 60, 70, 75, 80, 90, 85)
modern_stores = c(55, 75, 80, 90, 105, 65)

stores = data.frame(sells = c(classical_stores, modern_stores), 
                    store_type = factor(c(rep("C", length(classical_stores)), 
                                          rep("M", length(modern_stores)))))
coin::oneway_test(sells ~ store_type, stores, distribution = "exact")
wilcox.test(classical_stores, modern_stores, correct = TRUE)
```

<p dir="RTL">
برای مقایسهی میانگین دو گروه، با توجه به اینکه تعداد دادهها کم هستند و نمیتوان از t.test استفاده کرد، از Permutation Test استفاده میکنیم. با توجه به اینکه دادهی پرت داریم، انتخاب بهتر Wilcoxon Test است. 
در هر دو صورت، p-value بهدستآمده زیاد است. بنابراین فرض صفر که برابر بودن $\mu$ 9دو گروه است را نمیتوان رد کرد. 
</p>

***

<p dir="RTL">
۳. اطلاعات حسابداری ۱۵ شعبه که به صورت تصادفی انتخاب شده اند به شرح زیر است:
</p>

509, 517, 502, 629, 830, 911, 847, 803, 727, 853, 757, 730, 774, 718, 904

<p dir="RTL">
شرکت مذکور برای ارتقای فروش خود یک طرح تبلیغاتی جدید را اجرا میکند. پس از طرح جدید نتایج عملکرد شعبه ها  به صورت زیر 
اندازه گیری شده است
</p>

517, 508, 523, 730, 821, 940, 818, 821, 842, 842, 709, 688, 787, 780, 901

<p dir="RTL">
آیا تبلیغات جدید عملکرد فروش را بالا برده است؟
</p>

```{r warning=FALSE}
before = c(509, 517, 502, 629, 830, 911, 847, 803, 727, 853, 757, 730, 774, 718, 904)
after = c(517, 508, 523, 730, 821, 940, 818, 821, 842, 842, 709, 688, 787, 780, 901)

wilcox.test(before, after, pired = TRUE)
wilcox.test(before, after, pired = TRUE, alternative = "greater") # H0: before > after
```

<p dir="RTL">
برای مقایسهی میانگین قبل و بعد از اجرای طرح، با توجه به اینکه تعداد دادهها کم هستند، از Wilcoxon Test استفاده میکنیم. ابتدا برابر بودن میانگین این دو گروه را بررسی میکنیم. با توجه به اینکه p-value بهدستآمده زیاد است نمیتوان فرض صفر، یعنی برابر بودن میانگینها را رد کرد. 
روش دیگر این است که فرض صفر را بیشتر بودن میانگین before از after بگیریم که با توجه به p-value بهدستآمده این فرض نیست قابل رد نمیباشد و نمیتوان گفت میانگین after بیشتر از میانگین before است.
</p>

***

<p dir="RTL">
۴. محصولی در سه رنگ سفید آبی و قرمز تولید شده است.
پنج شعبه ار فروشگاه سازنده محصول به صورت تصادفی انتخاب شده و اطلاعات فروش آنها در زیر آمده است.
</p>

| Store | White | Blue | Red |
| :----: | :----: | :----: | :----: |
| 1. |	510 |	925 |	730 |
| 2. | 720 | 735 | 745 |
| 3. |	930 |	753 |	875 |
| 4. |	754 |	685 |	610 |
| 5. |	105	|  |  |

<p dir="RTL">
با توجه به داده های بالا آیا رنگی خاص در میزان فروش محصولات تاثیر دارد؟
</p>

```{r}
white = c(510, 720, 930, 754, 105)
blue = c(925, 735, 753, 685)
red = c(730, 745, 875, 610)

stores = data.frame(sells = c(white, blue, red),
                    color = factor(c(rep("white", length(white)), 
                                     rep("blue", length(blue)),
                                     rep("red", length(red)))))
kruskal.test(sells ~ color, data = stores)
```

<p dir="RTL">برای بررسی اینکه آیا نمونههای گروههای مختلف داده (که تعداد گروهها بیش از دو باشد)، از یک توزیع میآیند یا نه (میانگین آنها یکی است یا نه)، در صورتی که تعداد آنها نسبتاً کم باشد و شرایط استفاده از تستهای parametric برقرار نباشد، از Kruskal Test استفاده میکنیم. 
با توجه به اینکه مقدار p-value بهدستآمده بیش از ۰.۰۵ است، فرض صفر که یکسان بودن میانگین این گروههاست رد نمیشود و نمیتوان گفت که لزوماً رنگی خاص در میزان فروش محصولات تاثیر دارد.
</p>

***

<p dir="RTL">
۵. یک موسسه نظرسنجی نظرات مردم در مورد رضایت از یک محصول که در ماه های فروردین اردیبهشت خرداد و تیر که از طریق تلویزیون 
تبلیغ شده است را مورد ارزیابی قرار می دهد.این کار بدین صورت است از افرادی در ماه اول سوال پرسیده می شود و در ماه آینده نیز از همان فرد سوال می شود که آیا از محصول مذکور راضی هستی یا خیر.
با توجه به داده ایی که در پیوست تمرین آمده است آیا تبلیغات تاثیر مثبتی در افزایش رضایت مردم داشته است؟
</p>


```{r}
tv = read.csv("data/tv.csv")
friedman.test(cbind(tv$March, tv$April, tv$May, tv$Jun))
CVST::cochranq.test(tv)
```


<p dir="RTL">
ابتدا از آزمون Friedman استفاده شدهاست که برای مقایسه تفاوت بین گروههای مختلف وابستهی داده بهکار میرود (آزمون جایگزین non-parametric برای ANOVA)، استفاده شدهبود. ولی راه حل بهتر برای این سوال با توجه به اینکه دادهها دو حالتی (صفر و یکی) هستند، آزمون Cochran's Q است. که همین شرایط را دارد ولی برای دادههای دو حالتی طراحی شدهاست.
با توجه به اینکه مقدار p-value بهدستآمده بیش از ۰.۰۵ است، فرض صفر که یکسان بودن میانگین این گروههاست رد نمیشود و نمیتوان گفت که لزوماً تبلیغات تاثیر مثبتی در افزایش رضایت مردم داشته است.
</p>

***

<p dir="RTL"> 
۶. شرکتی در حال تحقیق بر روی این موضوع است که آیا جمعیت شهر تاثیری در نوع میزان مصرف محصولات شرکت دارد.
با توجه به داده زیر این موضوع را تحقیق کنید؟
</p>


| City size |	| Frequency of service usage | |
| :---: |  :---:  | :---: | :---: | 
| | Always	| Sometime | Never |
| Small	| 151	| 252	| 603 |
| Medium	| 802	| 603	| 405 |
| Large	| 753	| 55	| 408 |

```{r}
city_service = matrix(data = c(151, 802, 753, 252, 603, 55, 603, 405, 408), nrow = 3, ncol = 3)
rownames(city_service) = c("Small", "Medium", "Large" )
colnames(city_service) = c("Always" , "Sometime", "Never")

chisq.test(city_service)
```


<p dir="RTL"> 
برای پاسخ دادن به این سوال که آیا چند جمعیت مختلف توزیع یکسان (از یک متغیر categorical) دارند یا خیر از Chi-square test for homogeneity استفاده میکنیم. که در اینجا متغیر categorical، میزان مصرف محصولات شرکت است.
پس در اینجا فرض صفر این است که جمعیت شهر تاثیری در نوع میزان مصرف محصولات شرکت ندارد. با توجه به اینکه مقدار p-value بهدست آمده کمتر از ۰.۰۵ است، این فرض رد میشود و بنابراین جمعیت شهر در نوع میزان مصرف محصولات شرکت تاثیر دارد.
</p>

***

<p dir="RTL"> 
۷. شرکتی انتظار دارد با ارایه محصول الف میزان فروش محصول ب افزایش یابد.
به همین منظور به طور تصادفی از صد مشتری خود اطلاعات مصرف جمع آوری می نماید.
با توجه به داده های که داده شده آیا ربط معناداری بین فروش این دو محصول وجود دارد؟
</p>

```{r}
consumption = read.csv("data/consumption.csv")
shapiro.test(consumption$A)
shapiro.test(consumption$B)
cor.test(consumption$A, consumption$B, method = "spearman")
```

<p dir="RTL"> 
میخواهیم بررسی کنیم که آیا خرید محصول A تاثیری روی خرید محصول B داشته است یا خیر. برای این کار باید از Correlation test استفاده کنیم. که برای اینکه method این تست را مشخص کنیم باید ابتدا نرمال بودن توزیع فروش A و B را با استفاده از Shapiro–Wilk test بررسی کنیم. که در هر صورت توزیع نرمال نخواهد بود (p-valueی shapiro.test  ها بسیار کم است) و باید از Spearman's rank correlation coefficient (و یا همان متد spearman) استفاده کنیم. 
با توجه به اینکه مقدار rho بهدستآمده بسیار کم است، فرض صفر که تاثیر داشتن خرید A روی B است، رد میشود (چرا که در کورلیشینی بین این دو متغیر وجود نداشته) و در نتیجه خرید A روی B تاثیری ندارد.
</p>

***

<p dir="RTL"> 
۸. یک شرکت از ۲۰۰۰ نفر از مشتریان خود عامل خرید محصول را مورد سوال قرار میدهد 
که خلاصه اطلاعات آن را در زیر می توانید مشاهده کنید
</p>

| Characteristics	| Male	| Female |
| :---: |  :---:  | :---: |
| Price	| 301	| 502 |
| Design	| 353	| 155 |
| Color	| 558	| 153 |

<p dir="RTL"> 
آیا جنسیت تاثیری در مشخصه کاربری کالا دارد؟
</p>


```{r}
sells = matrix(data = c(301, 353, 558, 502, 155, 153), nrow = 3 , ncol = 2)
rownames(sells) = c("Price", "Design", "Color" )
colnames(sells) = c("Male" , "Female")
chisq.test(sells)
```

<p dir="RTL"> 
برای بررسی اینکه جنسیت تاثیری در مشخصه کاربری کالا دارد یا خیر در واقع میخواهیم وابستگی بین دو متغیر categorical (جنسیت و مشخصه کاربری کالا) را بررسی کنیم که برای این کار از Chi-Square Test of Independence استفاده میشود. با توجه به اینکه مقدار p-value بهدستآمده بیش از ۰.۰۵ است، فرض صفر که مستقل بودن این دو متغیر از هم است رد میشود و میتوان گفت جنسیت در مشخصه کاربری کالا تاثیر دارد.
</p>